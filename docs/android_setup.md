# Android Setup

To get the Android version of the app working correctly, a few changes must be applied to the default files generated by Capacitor.

<details>
  <summary><h3>Content</h3></summary>

- [HTTP Connections Permission](#http-connections-permission)
- [Post Notifications Permission](#post-notifications-permission)
- [Notification Icon](#notification-icon)
- [Splash Screen](#splash-screen)

</details>
<hr>

## HTTP Connections Permission

To allow HTTP connections from the app edit `android/app/src/main/AndroidManifest.xml` to have following attribute inside the `<application>` tag:

```xml
<application
  ...
  android:usesCleartextTraffic="true"
>
```

## Post Notifications Permission

In the same `android/app/src/main/AndroidManifest.xml`, add the following line after the existing `uses-permission` tags:

```xml
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
```

Then update `android/app/arc/main/java/io/ionic/stitched/MainActivity.java` to:

```java
package io.ionic.stitched;

import android.os.Build;
import android.Manifest;
import android.content.pm.PackageManager;
import android.os.Bundle;

import com.getcapacitor.BridgeActivity;

public class MainActivity extends BridgeActivity {
  @Override
  public void onStart() {
    super.onStart();
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
      if (checkSelfPermission(Manifest.permission.POST_NOTIFICATIONS) != PackageManager.PERMISSION_GRANTED) {
        requestPermissions(new String[]{Manifest.permission.POST_NOTIFICATIONS}, 1000);
      }
    }
  }
}
```

This ensures the app correctly requests notification permissions on Android 13+ devices.

## Notification Icon

Copy the notification icon file `resources/manual/ic_notif_icon.png` to the folder `android/app/src/main/res/drawable/` in your Android project.
Note that a production app should have multiple icon sizes for different screen densities, but for this app's purposes a single icon is enough.

## Splash Screen

In the file `android/app/src/main/res/values/styles.xml` replace:

```xml
<style name="AppTheme.NoActionBarLaunch" parent="Theme.SplashScreen">
  <item name="android:background">@drawable/splash</item>
</style>
```

With the following:

```xml
<style name="AppTheme.NoActionBarLaunch" parent="Theme.SplashScreen">
  <!-- For Android 12+ -->
  <item name="android:windowSplashScreenBackground">#121212</item>

  <!-- For Android 11 and below -->
  <item name="android:background">@drawable/splash</item>
</style>
```

This ensures the app's splash screen background color looks right on Android 12+ devices.

---

[<- Back to Main Page](../)
